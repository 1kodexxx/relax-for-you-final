---
import "@/styles/promo-banner.css";
---

<section id="promo-banner" class="promo-banner" hidden>
  <div class="promo-banner__panel">
    <button class="promo-banner__close" type="button" aria-label="–ó–∞–∫—Ä—ã—Ç—å">√ó</button>

    <div class="promo-banner__image">
      <picture>
        <!-- üì± –î–ª—è —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤ –∏ –ø–ª–∞–Ω—à–µ—Ç–æ–≤ -->
        <source srcset="/banner-mobile.jpg" media="(max-width: 1023px)" type="image/jpeg" />
        <!-- üíª –î–ª—è –Ω–æ—É—Ç–±—É–∫–æ–≤ –∏ –¥–µ—Å–∫—Ç–æ–ø–æ–≤ -->
        <source srcset="/banner-mobile.jpg" media="(min-width: 1024px)" type="image/png" />
        <!-- üß© fallback (–Ω–∞ —Å–ª—É—á–∞–π –µ—Å–ª–∏ <picture> –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è) -->
        <img src="/banner.png" alt="Relax GOLD" loading="lazy" decoding="async" />
      </picture>
    </div>

    <header class="promo-banner__header">
      <p class="promo-banner__eyebrow">üî• –°–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ</p>
      <h2 class="promo-banner__title_text">
        –î–ª—è <span>–ù–ê–®–ò–•</span> –∫–ª–∏–µ–Ω—Ç–æ–≤ <span>–°–ï–ô–ß–ê–°</span> –¥–µ–π—Å—Ç–≤—É–µ—Ç –∞–∫—Ü–∏—è ‚úÖ‚úÖ‚úÖ
      </h2>
    </header>

    <ul class="promo-banner__list">
      <li>
        üî• <b>Body EROTIC</b> –ø–æ –±—É–¥–Ω—è–º —Å 12:00 ‚Äì 16:00 ‚Üí <span class="price-banner">5000 ‚ÇΩ</span>
      </li>
      <li>üíé <b>–°–∫–∏–¥–∫–∞ 50%</b> –Ω–∞ VIP –≤ –î–µ–Ω—å –†–æ–∂–¥–µ–Ω–∏—è</li>
      <li>üéÅ –ü—Ä–∏–≤–µ–¥–∏ 3 –¥—Ä—É–∑–µ–π ‚Äî –ø–æ–ª—É—á–∏ –ú–ê–°–°–ê–ñ –≤ –ø–æ–¥–∞—Ä–æ–∫</li>
    </ul>

    <div class="promo-banner__actions">
      <a href="#booking" class="promo-banner__btn" data-booking-trigger> –ó–ê–ü–ò–°–ê–¢–¨–°–Ø –°–ï–ô–ß–ê–° </a>
    </div>
  </div>
</section>

<script is:inline>
  (() => {
    const banner = document.querySelector("#promo-banner");
    const closeBtn = banner?.querySelector(".promo-banner__close");
    const gallery = document.querySelector("#gallery");

    if (!banner || !gallery) return;

    const showBanner = () => {
      banner.hidden = false;
      banner.classList.add("visible");
    };

    const observer = new IntersectionObserver(
      (entries) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting) {
            showBanner();
            observer.disconnect();
          }
        });
      },
      { rootMargin: "0px 0px -15% 0px", threshold: 0.1 }
    );

    let endMarker = gallery.querySelector("[data-gallery-end]");
    if (!endMarker) {
      endMarker = document.createElement("div");
      endMarker.dataset.galleryEnd = "";
      endMarker.style.cssText = "width:100%;height:1px;";
      gallery.appendChild(endMarker);
    }

    observer.observe(endMarker);

    closeBtn?.addEventListener("click", () => {
      banner.classList.add("closing");
      setTimeout(() => banner.remove(), 300);
    });
  })();
</script>
